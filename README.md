# RTPL - Render Template

A command-line tool for rendering Jinja2 templates with data from various sources. RTPL (Render Template) allows you to combine template files with JSON data and environment variables to generate text output.

## Purpose

RTPL simplifies the process of generating configuration files, documents, or any text-based output by:

- Rendering Jinja2 templates with context data
- Supporting multiple input sources (files or stdin)
- Providing access to environment variables within templates
- Outputting to files or stdout

## Installation

### From Source

1. Ensure you have Rust and Cargo installed (https://rustup.rs/)
2. Clone this repository
3. Build the project:

```bash
cargo build --release
```

4. The binary will be available at `target/release/rtpl`

## Usage

RTPL can be used in several ways depending on your needs:

### Basic Usage

```bash
# Render a template file with environment variables
rtpl --template example.j2 --output result.txt

# Render a template from stdin
rtpl < example.j2 > result.txt

# Render a template with JSON data
rtpl --template example.j2 --data-file data.json --output result.txt
```

### Input Methods

RTPL accepts templates and data from various sources:

1. **Template from stdin**:
```bash
rtpl << EOF > result.txt
Hello {{ _ENV['USER'] }}!
Your home is at {{ _ENV['HOME'] }}
EOF
```

2. **Template from file, data from stdin**:
```bash
rtpl --template example.j2 << EOF > output.txt
{
  "name": "John Doe",
  "age": 30
}
EOF
```

3. **Template and data from files**:
```bash
rtpl --template example.j2 --data-file data.json --output result.txt
```

### Environment Variables

Environment variables are automatically available in templates via the `_ENV` object:

```bash
rtpl << EOF
Username: {{ _ENV['USER'] }}
Home directory: {{ _ENV['HOME'] }}
EOF
```

## Examples

### Example 1: Generate a configuration file

**Template (config.j2):**
```
server {
    listen {{ port | default(80) }};
    server_name {{ server_name }};
    root {{ _ENV['HOME'] }}/sites/{{ site_name }};
}
```

**Data (config.json):**
```json
{
  "port": 8080,
  "server_name": "example.com",
  "site_name": "my-website"
}
```

**Command:**
```bash
rtpl --template config.j2 --data-file config.json --output nginx.conf
```

### Example 2: Generate a report with inline template

```bash
rtpl << EOF > report.txt
# System Report

Generated by: {{ _ENV['USER'] }}
Date: {{ _ENV['DATE'] | default("Unknown") }}

## System Information
- Hostname: {{ hostname | default("Unknown") }}
- Environment: {{ environment | default("development") }}
EOF
```

## Parameters

- `--template, -t`: The template file to render. If not specified, the script will read from stdin.
- `--stdin`: The input type. It can be `template` or `data`. If not specified, it tries to guess based on other parameters.
- `--output, -o`: The output file. If not specified, the script will print to stdout.
- `--data-file`: The JSON data file to use for template rendering.

## known issues
- Tera throws error when variables are not found in the context.
